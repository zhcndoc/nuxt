---
title: Nuxt 4.1
description: Nuxt 4.1 æ­£å¼å‘å¸ƒâ€”â€”å¸¦æ¥æ›´ç¨³å®šçš„æ„å»ºã€æ›´ä½³çš„å¼€å‘ä½“éªŒï¼Œä»¥åŠä¸ºæ¨¡å—ä½œè€…æä¾›çš„å¼ºå¤§æ–°åŠŸèƒ½ï¼
navigation: false
image: /assets/blog/v4.1.png
authors:
  - name: Daniel Roe
    avatar:
      src: https://markhub.top/github/danielroe
    to: https://bsky.app/profile/danielroe.dev
date: 2025-09-02T10:00:00.000Z
category: Release
---

## ğŸ”¥ æ„å»ºä¸æ€§èƒ½æ”¹è¿›

### ğŸ« å¢å¼ºçš„ Chunk ç¨³å®šæ€§

é€šè¿‡ import map æŠ€æœ¯æ˜¾è‘—æå‡äº†æ„å»ºçš„ç¨³å®šæ€§ï¼ˆ[#33075](https://github.com/nuxt/nuxt/pull/33075)ï¼‰ã€‚è¿™èƒ½å¤Ÿé¿å…ç”±äºå°æ”¹åŠ¨å¯¼è‡´çš„å¤§èŒƒå›´æ„å»ºæ•£åˆ—å“ˆå¸Œå˜åŒ–ï¼š

```html
<!-- è‡ªåŠ¨æ³¨å…¥çš„ import map -->
<script type="importmap">{"imports":{"#entry":"/_nuxt/DC5HVSK5.js"}}</script>
```

åœ¨ Vite æ„å»ºä¸­ï¼Œç”Ÿæˆçš„ JS chunk é»˜è®¤ä¼šè¢«å“ˆå¸Œå¤„ç†ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥è¢«ä¸å¯å˜åœ°ç¼“å­˜ã€‚ä½†è¿™ä¼šå¸¦æ¥ä¸€ä¸ªé‡å¤§é—®é¢˜ï¼šå•ä¸ªç»„ä»¶çš„æ”¹åŠ¨å¯èƒ½å¯¼è‡´ _æ‰€æœ‰_ å“ˆå¸Œæ–‡ä»¶å¤±æ•ˆï¼Œå¤§å¤§å¢åŠ  404 é”™è¯¯çš„é£é™©ã€‚

ç®€è€Œè¨€ä¹‹ï¼š

1. ç»„ä»¶è½»å¾®å˜åŠ¨ â€”â€” è¯¥ç»„ä»¶ JS chunk çš„å“ˆå¸Œå˜æ›´
2. ä½¿ç”¨è¯¥ç»„ä»¶çš„é¡µé¢éœ€æ›´æ–°ä»¥å¼•ç”¨æ–°çš„æ–‡ä»¶å
3. _entry_ æ–‡ä»¶å› åŠ¨æ€å¯¼å…¥è¯¥é¡µé¢è€Œå“ˆå¸Œéšä¹‹æ”¹å˜
4. å¯¼å…¥ entry çš„ _å…¶ä»–æ‰€æœ‰æ–‡ä»¶_ å“ˆå¸Œéƒ½è¢«æ”¹å˜

æ˜¾ç„¶ï¼Œè¿™ç§æƒ…å†µå¹¶ä¸ç†æƒ³ã€‚å¼€å¯æ­¤æ–°ç‰¹æ€§åï¼Œå¯¼å…¥ entry çš„å…¶ä»–æœªå˜æ›´æ–‡ä»¶çš„å“ˆå¸Œå°†ä¸ä¼šå—åˆ°å½±å“ã€‚

è¯¥åŠŸèƒ½é»˜è®¤å¯ç”¨ï¼Œæœ‰åŠ©äºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æå‡ç¼“å­˜æ•ˆç‡ã€‚å®ƒä¾èµ–äº [åŸç”Ÿ import map æ”¯æŒ](https://caniuse.com/import-maps)ï¼Œå¦‚æœä½ é…ç½®äº† `vite.build.target` åŒ…å«ä¸æ”¯æŒ import map çš„æµè§ˆå™¨ï¼ŒNuxt ä¼šè‡ªåŠ¨ç¦ç”¨æ­¤åŠŸèƒ½ã€‚

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦æ‰‹åŠ¨ç¦ç”¨ï¼š

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  experimental: {
    entryImportMap: false
  }
})
```

### ğŸ¦€ å®éªŒæ€§ Rolldown æ”¯æŒ

Nuxt ç°å·²å®éªŒæ€§æ”¯æŒ `rolldown-vite`ï¼ˆ[#31812](https://github.com/nuxt/nuxt/pull/31812)ï¼‰ï¼Œè¿™æ˜¯ä¸€æ¬¾åŸºäº Rust çš„æ‰“åŒ…å·¥å…·ï¼Œå¯å¸¦æ¥æ›´å¿«çš„æ„å»ºé€Ÿåº¦ã€‚

åœ¨ Nuxt é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨ Rolldownï¼Œéœ€è¦é€šè¿‡åŒ…è¦†ç›–æ¥æ›¿æ¢é»˜è®¤çš„ Vite ç‰ˆæœ¬ï¼Œå› ä¸º Vite æ˜¯ Nuxt çš„ä¾èµ–ã€‚è¯·åœ¨ä½ çš„ `package.json` ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

::code-group{sync="pm"}
```json [npm]
{
  "overrides": {
    "vite": "npm:rolldown-vite@latest"
  }
}
```

```json [pnpm]
{
  "pnpm": {
    "overrides": {
      "vite": "npm:rolldown-vite@latest"
    }
  }
}
```

```json [yarn]
{
  "resolutions": {
    "vite": "npm:rolldown-vite@latest"
  }
}
```

```json [bun]
{
  "overrides": {
    "vite": "npm:rolldown-vite@latest"
  }
}
```
::

æ·»åŠ è¦†ç›–åï¼Œé‡æ–°å®‰è£…ä¾èµ–ã€‚Nuxt ä¼šè‡ªåŠ¨æ£€æµ‹ Rolldown çš„å¯ç”¨æ€§ï¼Œå¹¶ç›¸åº”è°ƒæ•´æ„å»ºé…ç½®ã€‚

æœ‰å…³ Rolldown é›†æˆçš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜… [Vite Rolldown æŒ‡å—](https://vite.dev/guide/rolldown)ã€‚

::note
è¯¥åŠŸèƒ½ä»å¤„äºå®éªŒé˜¶æ®µï¼Œå¯èƒ½å­˜åœ¨é™åˆ¶ï¼Œä½†å®ƒé¢„ç¤ºç€ Nuxt é«˜æ€§èƒ½æ‰“åŒ…çš„æœªæ¥æ–¹å‘ã€‚
::

## ğŸ§ª æ”¹è¿›çš„æ‡’åŠ è½½æ°´åˆï¼ˆLazy Hydrationï¼‰

æ‡’åŠ è½½æ°´åˆå®ç°æ”¯æŒæ— è‡ªåŠ¨å¯¼å…¥çš„ä½¿ç”¨æƒ…å†µï¼ˆ[#33037](https://github.com/nuxt/nuxt/pull/33037)ï¼‰ï¼Œæå‡äº†ç»„ä»¶è‡ªåŠ¨å‘ç°è¢«ç¦ç”¨æ—¶çš„å¯é æ€§ï¼š

```vue
<script setup>
// å³ä½¿ components é…ç½®ä¸º false ä¹Ÿå¯æ­£å¸¸å·¥ä½œ
const LazyComponent = defineLazyHydrationComponent(
  'visible',
  () => import('./MyComponent.vue')
)
</script>
```

è¿™ä¿è¯äº†å³ä¾¿ç»„ä»¶æœªé€šè¿‡ Nuxt è‡ªåŠ¨â€œå‘ç°â€ï¼ˆä¾‹å¦‚é…ç½®ä¸­ `components: false`ï¼‰ï¼Œä»å¯åœ¨æ‡’åŠ è½½æ°´åˆå®ä¸­ä½¿ç”¨ã€‚

## ğŸ“„ å¼ºåŒ–çš„é¡µé¢è§„åˆ™

å¦‚æœå¼€å¯äº†å®éªŒæ€§çš„è·¯ç”±è§„åˆ™æå–ï¼Œè¿™äº›è§„åˆ™ç°åœ¨ä¼šæš´éœ²åœ¨ `NuxtPage` å¯¹è±¡ä¸Šçš„ä¸“å± `rules` å±æ€§ä¸­ï¼ˆ[#32897](https://github.com/nuxt/nuxt/pull/32897)ï¼‰ï¼Œæé«˜æ¨¡å—è®¿é—®çš„ä¾¿åˆ©æ€§å¹¶ä¼˜åŒ–æ•´ä½“æ¶æ„ï¼š

```ts
// åœ¨ä½ çš„æ¨¡å—ä¸­
nuxt.hook('pages:extend', pages => {
  pages.push({
    path: '/api-docs',
    rules: { 
      prerender: true,
      cors: true,
      headers: { 'Cache-Control': 's-maxage=31536000' }
    }
  })
})
```

`defineRouteRules` å‡½æ•°ä»å®Œå…¨å…¼å®¹ï¼Œä½†ç°åœ¨ä¸ºæ¨¡å—æä¾›äº†æ›´å¥½çš„é›†æˆå¯èƒ½ã€‚

## ğŸš€ æ¨¡å—å¼€å‘å¢å¼º

### ğŸª¾ æ¨¡å—ä¾èµ–ä¸é›†æˆ

æ¨¡å—ç°åœ¨å¯ä»¥å£°æ˜ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸ºå…¶ä»–æ¨¡å—ä¿®æ”¹é…ç½®é€‰é¡¹ï¼ˆ[#33063](https://github.com/nuxt/nuxt/pull/33063)ï¼‰ã€‚è¿™æé«˜äº†æ¨¡å—é—´é›†æˆåº¦ï¼Œå¹¶ç¡®ä¿æ­£ç¡®çš„å®‰è£…é¡ºåºï¼š

```ts
export default defineNuxtModule({
  meta: {
    name: 'my-module',
  },
  moduleDependencies: {
    'some-module': {
      // å¯æŒ‡å®šæ‰€ä¾èµ–æ¨¡å—çš„ç‰ˆæœ¬çº¦æŸ
      version: '>=2',
      // é»˜è®¤æƒ…å†µä¸‹ï¼ŒmoduleDependencies ä¼šæ·»åŠ åˆ° Nuxt å®‰è£…åˆ—è¡¨ï¼Œé™¤éæ ‡è®°ä¸º optionalã€‚
      optional: true,
      // ä»»æ„è¦è¦†ç›– nuxt.options çš„é…ç½®
      overrides: {},
      // å°†è®¾ç½®çš„é»˜è®¤é…ç½®ï¼Œä¼šè¦†ç›–æ¨¡å—é»˜è®¤ï¼Œä½†ä¸ä¼šè¦†ç›– nuxt.options ä¸­å·²æœ‰é…ç½®ã€‚
      defaults: {}
    }
  },
  setup (options, nuxt) {
    // ä½ çš„æ¨¡å—æ­å»ºé€»è¾‘
  }
})
```

è¯¥åŠŸèƒ½ç”¨æ¥æ›¿ä»£å·²åºŸå¼ƒçš„ `installModule` å‡½æ•°ï¼Œå¹¶æä¾›æ›´å¼ºå¤§çš„æ¨¡å—ä¾èµ–å¤„ç†èƒ½åŠ›ï¼Œæ”¯æŒç‰ˆæœ¬çº¦æŸå’Œé…ç½®åˆå¹¶ã€‚

### ğŸª æ¨¡å—ç”Ÿå‘½å‘¨æœŸé’©å­

æ¨¡å—ä½œè€…ç°å¯ä½¿ç”¨ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š`onInstall` å’Œ `onUpgrade`ï¼ˆ[#32397](https://github.com/nuxt/nuxt/pull/32397)ï¼‰ã€‚è¿™å…è®¸æ¨¡å—åœ¨é¦–æ¬¡å®‰è£…æˆ–å‡çº§æ—¶æ‰§è¡Œé¢å¤–çš„åˆå§‹åŒ–æ­¥éª¤ï¼š

```ts
export default defineNuxtModule({
  meta: {
    name: 'my-module',
    version: '1.0.0',
  },

  onInstall(nuxt) {
    // æ¨¡å—é¦–æ¬¡å®‰è£…æ—¶è¿è¡Œ
    console.log('é¦–æ¬¡å®‰è£… my-moduleï¼Œå¼€å§‹åˆå§‹åŒ–ï¼')
  },

  onUpgrade(inlineOptions, nuxt, previousVersion) {
    // æ¨¡å—å‡çº§æ—¶è¿è¡Œ
    console.log(`å‡çº§ my-moduleï¼Œä»ç‰ˆæœ¬ v${previousVersion}`)
  }
})
```

é’©å­ä»…åœ¨æ¨¡å—å…ƒæ•°æ®ä¸­åŒæ—¶æä¾› `name` å’Œ `version` æ—¶è§¦å‘ã€‚Nuxt å†…éƒ¨ä½¿ç”¨ `.nuxtrc` æ–‡ä»¶è·Ÿè¸ªæ¨¡å—ç‰ˆæœ¬å¹¶è§¦å‘å¯¹åº”é’©å­ã€‚ï¼ˆå¦‚æœæœªæ¥è§¦è¿‡ï¼Œ`.nuxtrc` æ–‡ä»¶åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰

::tip
è¿™è®©æ¨¡å—ä½œè€…èƒ½å¤Ÿå®ç°è‡ªå®šä¹‰â€œè®¾ç½®å‘å¯¼â€ï¼Œåœ¨æ¨¡å—å®‰è£…åéœ€è¦å®ŒæˆæŸäº›è®¾ç½®æ—¶æä¾›æ›´ä½³ä½“éªŒã€‚
::

### ğŸ™ˆ å¢å¼ºçš„æ–‡ä»¶è§£æ

`resolveFiles` æ–°å¢ `ignore` é€‰é¡¹ï¼ˆ[#32858](https://github.com/nuxt/nuxt/pull/32858)ï¼‰ï¼Œå…è®¸æ¨¡å—ä½œè€…æ ¹æ® glob æ¨¡å¼æ’é™¤æŒ‡å®šæ–‡ä»¶ï¼š

```ts
// è§£ææ‰€æœ‰ .vue æ–‡ä»¶ï¼Œæ’é™¤æµ‹è¯•æ–‡ä»¶
const files = await resolveFiles(srcDir, '**/*.vue', {
  ignore: ['**/*.test.vue', '**/__tests__/**']
})
```

### ğŸ“‚ å±‚ç›®å½•å·¥å…·

å…¨æ–°æä¾›çš„ `getLayerDirectories` å·¥å…·ï¼ˆ[#33098](https://github.com/nuxt/nuxt/pull/33098)ï¼‰è®©è®¿é—®å±‚ç›®å½•æ›´ç®€æ´ï¼Œæ— éœ€ç›´æ¥ä½¿ç”¨ç§æœ‰ APIï¼š

```ts
import { getLayerDirectories } from '@nuxt/kit'

const layerDirs = await getLayerDirectories(nuxt)
// è®¿é—®å…³é”®ç›®å½•ï¼š
// layerDirs.app        - é»˜è®¤ /app/
// layerDirs.appPages   - é»˜è®¤ /app/pages
// layerDirs.server     - é»˜è®¤ /server
// layerDirs.public     - é»˜è®¤ /public
```

## âœ¨ å¼€å‘è€…ä½“éªŒæå‡

### ğŸ± ç®€åŒ–çš„ Kit å·¥å…·

å¤šä¸ª kit å·¥å…·å¾—åˆ°æ”¹è¿›ï¼Œä¼˜åŒ–å¼€å‘ä½“éªŒï¼š

- `addServerImports` ç°åœ¨æ”¯æŒå•æ¡å¯¼å…¥å‚æ•°ï¼ˆ[#32289](https://github.com/nuxt/nuxt/pull/32289)ï¼‰ï¼š

```ts
// ä»¥å‰ï¼šå¿…é¡»ä¼ æ•°ç»„
addServerImports([{ from: 'my-package', name: 'myUtility' }])

// ç°åœ¨ï¼šå¯ç›´æ¥ä¼ å•ä¸ªå¯¹è±¡
addServerImports({ from: 'my-package', name: 'myUtility' })
```

### ğŸ”¥ æ€§èƒ½ä¼˜åŒ–

æœ¬æ¬¡å‘å¸ƒåŒ…æ‹¬ä»¥ä¸‹å†…éƒ¨æ€§èƒ½æå‡ï¼š

- è·¯ç”±è§„åˆ™ç¼“å­˜ç®¡ç†ä¼˜åŒ–ï¼ˆ[#32877](https://github.com/nuxt/nuxt/pull/32877)ï¼‰
- åº”ç”¨æ¸…å•ç›‘å¬ä¼˜åŒ–ï¼ˆ[#32880](https://github.com/nuxt/nuxt/pull/32880)ï¼‰
- é¡µé¢å…ƒæ•°æ® TypeScript å¤„ç†æ”¹è¿›ï¼ˆ[#32920](https://github.com/nuxt/nuxt/pull/32920)ï¼‰

## ğŸ› é‡è¦ä¿®å¤

- ä¼˜åŒ– `useFetch` é’©å­ç±»å‹å®šä¹‰ï¼ˆ[#32891](https://github.com/nuxt/nuxt/pull/32891)ï¼‰
- æ›´å¥½åœ°å¤„ç†é¡µé¢å…ƒæ•°æ®ä¸­çš„ TypeScript è¡¨è¾¾å¼ï¼ˆ[#32902](https://github.com/nuxt/nuxt/pull/32902), [#32914](https://github.com/nuxt/nuxt/pull/32914)ï¼‰
- è·¯ç”±åŒ¹é…ä¸åŒæ­¥å¢å¼ºï¼ˆ[#32899](https://github.com/nuxt/nuxt/pull/32899)ï¼‰
- å‡å°‘å¼€å‘ç¯å¢ƒä¸­ Vue æœåŠ¡å™¨è­¦å‘Šçš„å†—ä½™ä¿¡æ¯ï¼ˆ[#33018](https://github.com/nuxt/nuxt/pull/33018)ï¼‰
- `<NuxtTime>` ä¸­ç›¸å¯¹æ—¶é—´è®¡ç®—çš„æ”¹è¿›ï¼ˆ[#32893](https://github.com/nuxt/nuxt/pull/32893)ï¼‰

## âœ… å‡çº§æŒ‡å—

ç…§æ—§ï¼Œæˆ‘ä»¬æ¨èçš„å‡çº§æ“ä½œæ˜¯ï¼š

```sh
npx nuxt upgrade --dedupe
```

è¿™å°†åˆ·æ–°ä½ çš„é”æ–‡ä»¶ï¼Œå¹¶æ‹‰å–æ‰€æœ‰ Nuxt ä¾èµ–ï¼Œå°¤å…¶æ˜¯ unjs ç”Ÿæ€ç›¸å…³çš„æœ€æ–°å†…å®¹ã€‚

## ğŸ“¦ Nuxt 3.19

ä¸Šè¿°åŠŸèƒ½åŒæ ·é€‚ç”¨äº **Nuxt 3.19**ï¼Œå®ƒä¸ v4.1 åŒæ­¥å‘å¸ƒã€‚ä½œä¸ºå¯¹ v3 åˆ†æ”¯çš„æ‰¿è¯ºï¼Œæˆ‘ä»¬æŒç»­å›ç§»å…¼å®¹çš„ v4 ç‰¹æ€§ï¼Œç¡®ä¿ v3 ç”¨æˆ·åŒæ ·èƒ½å—ç›Šæœ€æ–°æ”¹è¿›ã€‚

å¦‚æœä½ ä»åœ¨ä½¿ç”¨ Nuxt 3ï¼Œå¯å‡çº§è‡³ v3.19ï¼Œä»¥åœ¨ç¨³å®šçš„ v3 ç³»åˆ—ä¸­äº«ç”¨å…¨éƒ¨è¿™äº›æ–°ç‰¹æ€§ã€‚

## å®Œæ•´å‘è¡Œè¯´æ˜

::read-more
---
icon: i-simple-icons-github
target: _blank
to: https://github.com/nuxt/nuxt/releases/tag/v4.1.0
---
é˜…è¯» Nuxt `v4.1.0` çš„å®Œæ•´å‘è¡Œè¯´æ˜ã€‚
::

::read-more
---
icon: i-simple-icons-github
target: _blank
to: https://github.com/nuxt/nuxt/releases/tag/v3.19.0
---
é˜…è¯» Nuxt `v3.19.0` çš„å®Œæ•´å‘è¡Œè¯´æ˜ã€‚
::

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…ï¼æˆ‘ä»¬æœŸå¾…çœ‹åˆ°ä½ åˆ©ç”¨è¿™äº›æ–°åŠŸèƒ½åˆ›é€ å‡ºç²¾å½©ä½œå“ã€‚â¤ï¸
